<link rel="import" href="../../../../bower_components/polymer/polymer.html">

<dom-module id="create-folder">
    <style>
        .yellow-button {
            text-transform: none;
            color: #eeff41;
        }
    </style>
    <template>
        <iron-ajax id="ajax"
                   auto
                   url="http://localhost:2880/drestapi/CREATE/"
                   method="POST"
                   content-type="application/json"
                   headers$='[[_computeHeaders(isSomebody)]]'
                   body='{"parentPath":"{{path}}", "directoryName":"{{fileName}}"}'
                   handle-as="json" on-response="handleResponse" on-error="handleError">
        </iron-ajax>
    </template>
    <script>
        CreateFolder = Polymer({
            is: 'create-folder',

            properties: {
                fileName: {
                    type: String,
                    notify: true
                },
                
                path: {
                    type: String,
                    notify: true
                },

                isSomebody: {
                    type: Boolean,
                    value: true,
                    notify: true
                },
            },

            //Elememt Constructor
            factoryImpl: function(fileName, path) {
                this.fileName = fileName;
                this.path = path;
            },

            //EventHandlers Functions
            //=======================

            _computeHeaders: function(isSomebody){
                if(isSomebody == true){
                    return '{"Accept":"application/json", "Authorization":"Basic YWRtaW46ZGlja2VyZWxjaA==' + '"}';
                } else {
                    return '{"Accept":"application/json"}';
                }
            },

            handleResponse: function(e) {
                app.$.toast.text = e.target.lastRequest.xhr.response.messages;
                app.$.toast.show();
                setTimeout(function(){location.reload();} , 1000);   
                //console.log(e.target.lastRequest.xhr.response.messages);
            },

            handleError: function(e){
                app.$.toast.text = e.detail.request.xhr.response.messages;
                app.$.toast.show();
                //console.log(e.detail.request.xhr.response.messages);
            },
        });
    </script>
</dom-module>

